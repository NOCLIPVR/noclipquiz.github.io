<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Epic Staff Quiz</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
    h1 { text-align: center; }
    .question { margin-bottom: 20px; background: #fff; padding: 15px; border-radius: 8px; }
    .question h2 { margin-top: 0; }
    label { display: block; margin: 5px 0; }
    .submit-btn { padding: 10px 20px; font-size: 18px; cursor: pointer; }
    .name-field { margin-bottom: 20px; }
  </style>
</head>
<body>

<h1>Epic Staff Quiz</h1>

<!-- Name Field -->
<div class="name-field">
  <label for="name">Enter your name:</label>
  <input type="text" id="name" name="name" placeholder="Your name..." required>
</div>

<form id="quizForm">

  <!-- Questions 1–13 -->
  <div class="question" data-answer="meep">
    <h2>1. What is Epic's catchphrase?</h2>
    <label><input type="radio" name="q1" value="meep"> meep</label>
    <label><input type="radio" name="q1" value="bazinka"> bazinka</label>
  </div>

  <div class="question" data-answer="buckteeth">
    <h2>2. What emoji is §'s son?</h2>
    <label><input type="radio" name="q2" value="silly billy"> silly billy</label>
    <label><input type="radio" name="q2" value="joe bonkers"> joe bonkers</label>
    <label><input type="radio" name="q2" value="buckteeth"> buckteeth</label>
  </div>

  <!-- More questions here... -->

  <div class="question" data-answer="kat">
    <h2>13. Who's just the chillest of all guys?</h2>
    <label><input type="radio" name="q13" value="§"> §</label>
    <label><input type="radio" name="q13" value="kat"> kat</label>
    <label><input type="radio" name="q13" value="leader"> leader</label>
  </div>

  <!-- Question 14 and 15... -->

  <button class="submit-btn" type="submit">Submit Quiz</button>
</form>

<script>
const form = document.getElementById('quizForm');
const webhookURL = "https://discord.com/api/webhooks/1368602951374995477/-FxPP4iZtpRbuSGBOfy2aRRQu0ERtB6Kgk3MD5bz5UEFBqzi7jctA7ukIVgQd-d7SNeC"; // Replace with your Discord webhook URL

// Prevent resubmission after page refresh
if (localStorage.getItem('quizSubmitted') === 'true') {
  [...form.elements].forEach(el => el.disabled = true);
  document.querySelector('.submit-btn').style.display = 'none';
  const doneMsg = document.createElement('p');
  doneMsg.textContent = "✅ You've already submitted this quiz.";
  doneMsg.style.color = "green";
  doneMsg.style.fontSize = "18px";
  form.appendChild(doneMsg);
}

// Staff selection logic and other event handlers here...

form.addEventListener('submit', function(e) {
  e.preventDefault();

  const answers = {};
  let valid = true;
  let score = 0;
  let resultText = '';

  // Get the name from the name field
  const name = form.name.value.trim();
  if (!name) {
    alert('Please enter your name.');
    valid = false;
    return;
  }

  // Add name to resultText
  resultText += `Name: ${name}\n`;

  // Process each question...
  document.querySelectorAll('.question').forEach((q, i) => {
    const name = `q${i + 1}`;
    const correctAnswer = q.getAttribute('data-answer');

    let value = null;
    if (i + 1 === 14) {
      value = form[name].value.trim();
    } else if (i + 1 === 15) {
      const selected = [...form[name]].filter(cb => cb.checked).map(cb => cb.value);
      if (selected.length !== 7) {
        alert('You must select exactly 7 staff members in Question 15.');
        valid = false;
        return;
      }
      value = selected;
    } else {
      const selected = form[name].value;
      if (!selected) {
        valid = false;
        return;
      }
      value = selected;
    }

    if (!value || (Array.isArray(value) && value.length === 0)) {
      valid = false;
    }

    answers[name] = value;

    if (i + 1 !== 14 && i + 1 !== 15) {
      const isCorrect = value === correctAnswer;
      score += isCorrect ? 1 : 0;
      resultText += `Q${i + 1}: ${isCorrect ? '✅' : '❌'} (${value})\n`;
    } else if (i + 1 === 14) {
      resultText += `Q14: ✏️ (${value})\n`;
    } else {
      resultText += `Q15: 🎯 [${value.join(', ')}]\n`;
    }
  });

  if (!valid) {
    alert('Please answer all fields before submitting.');
    return;
  }

  resultText += `\n**Score: ${score}/14**`;

  fetch(webhookURL, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
      content: "📝 **New Quiz Submission**\n" + resultText
    })
  }).then(() => {
    alert("Submitted successfully!");

    // Set submission flag in localStorage
    localStorage.setItem('quizSubmitted', 'true');

    // Disable the form
    [...form.elements].forEach(el => el.disabled = true);

    // Hide submit button
    document.querySelector('.submit-btn').style.display = 'none';

    // Show message
    const msg = document.createElement('p');
    msg.textContent = "✅ You've already submitted this quiz.";
    msg.style.color = "green";
    msg.style.fontSize = "18px";
    form.appendChild(msg);

  }).catch(() => {
    alert("Failed to send to Discord webhook.");
  });
});
</script>

</body>
</html>
